{% extends 'base.html' %}
{% block content %}
<h2>Projects</h2>
<a class="btn primary" href="{{ url_for('admin_project_new') }}">+ New Project</a>

<div class="grid">
  {% for p in projects %}
    <div class="card">
      <div class="chips">
        <span class="chip">{{ p.tech.name if p.tech else 'No Tech' }}</span>
        {% if p.price_quote %}<span class="chip">â‚¹{{ p.price_quote }}</span>{% endif %}
        <span class="chip">#{{ p.id }}</span>
      </div>
      <h3>{{ p.title }}</h3>
      <p>{{ p.short_desc }}</p>
      {% if p.images %}
        <div class="gallery">
          {% for img in p.images %}
            <div>
              <img src="{{ url_for('uploaded_file', filename=img.filename) }}" alt="img">
              <form method="post" action="{{ url_for('admin_image_delete', image_id=img.id) }}">
                <button class="btn danger" style="margin-top:.3rem" type="submit">Delete Image</button>
              </form>
            </div>
          {% endfor %}
        </div>
      {% endif %}
      <div style="display:flex; gap:.5rem; margin-top:.5rem">
        <a class="btn" href="{{ url_for('admin_project_edit', project_id=p.id) }}">Edit</a>
        <form method="post" action="{{ url_for('admin_project_delete', project_id=p.id) }}">
          <button class="btn danger" type="submit">Delete</button>
        </form>
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}
